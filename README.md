# DevOps

### ๐ฝ ุฏุงูููุฏ ูุงู ูุง
``` bash
git clone https://github.com/samadelmakchi/devops.git
```
---

### โ๏ธ ูุตุจ ู ฺฉุงููฺฏ ุณุฑูุฑ
``` bash
cd devops

bash -x setup.sh
```
---

### ๐ฆ ุงูุฒูุฏู ฺฉูุฏ SSH ุจู ุญุณุงุจ GitLab / Github
ุจุฑุง ุฏุณุชุฑุณ ุขุณุงู ู ุงูู ุจู ูุฎุงุฒู GitLabุ ูุทูุงู ฺฉูุฏ ุนููู (Public Key) ุฎูุฏ ุฑุง ุจู ุญุณุงุจ ฺฉุงุฑุจุฑโุชุงู ุงุถุงูู ููุงุฏ. ุจุฑุง ุงู ฺฉุงุฑ ูุฑุงุญู ุฒุฑ ุฑุง ุฏูุจุงู ฺฉูุฏ:
1. ูุงุฑุฏ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฎูุฏ ุฏุฑ GitLab / Github ุดูุฏ.
2. ุจู ุตูุญู `https://github.com/settings/ssh/new` / `https://gitlab.com/-/user_settings/ssh_keys` ูุฑุงุฌุนู ฺฉูุฏ:
3. ูุงู ฺฉูุฏ ุนููู ุดูุง ุจุง ูุงู `id_rsa.pub` ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุชูุณุท ุงุณฺฉุฑูพุช `setup.sh` ุงุฌุงุฏ ุดุฏู ู ุฏุฑ ูพูุดู ุงุตู ูพุฑูฺู ูุฑุงุฑ ุฏุงุฑุฏ.
4. ูุญุชูุง ุงู ูุงู ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ูุณูุช `Key` ูุงุฑุฏ ููุงุฏ.
5. ฺฉ ุนููุงู ุฏูุฎูุงู ุฏุฑ ูุณูุช `Title` ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู: "DevOps").
6. ุฏุฑ ูพุงุงูุ ุฑู ฺฏุฒูู `Add key` ฺฉูฺฉ ฺฉูุฏ.

---

### ๐ค ูุตุจ ุงุจุฒุงุฑูุง ุฏูุงูพุณ
ูุทูุงู ูุจู ุงุฒ ุงุฌุฑุง ูุฑุขูุฏ ูุตุจุ ูุงู ุชูุธูุงุช `inventory-server.local.yml` ุฑุง ุฏุฑ ูพูุดู ุงุตู ุจุงุฒ ฺฉุฑุฏู ู ูุทุงุจู ูุงุฒูุง ุฎูุฏุ ุชุบุฑุงุช ูุงุฒู ุฑุง ุฏุฑ ุขู ุงุนูุงู ฺฉูุฏ.

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory-server.local.yml playbook-server.yml --ask-become-pass
```

---

### ๐ฆ ูุตุจ ูพุฑูฺู ูุง ูุดุชุฑุงู
ูุทูุงู ูุงู `inventory.local.yml` ุฑุง ุจุงุฒ ฺฉุฑุฏู ู ุงุทูุงุนุงุช ูุฑุจูุท ุจู ูุดุชุฑุงู ุฑุง ุฏุฑ ุขู ูุงุฑุฏ ููุงุฏ.

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory.local.yml playbook.yml --ask-become-pass
```

---

### ๐งช ุงูุฌุงู ุชุณุช ูุง ุงุชููุงุชฺฉ

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory.local.yml playbook-test.yml --ask-become-pass
```

---

### ๐ ุฑุงูููุง ุงุฎุชุตุงุต ุณุงุจโุฏุงูู ุจู ุณุฑูุณโูุง

#### **ุฑูุด ุงูู: ุงุณุชูุงุฏู ุงุฒ ูพูู DirectAdmin**
1. ุจู ูพูู **DirectAdmin** ูุงุฑุฏ ุดูุฏ.
2. ุจู ุจุฎุด **DNS Management** ูุฑุงุฌุนู ฺฉูุฏ.
3. ุฑู ฺฏุฒูู **Add Record** ฺฉูฺฉ ฺฉูุฏ.
4. ููุฏูุง ููุฑุฏูุธุฑ ุฑุง ุจูโุตูุฑุช ุฒุฑ ุชฺฉูู ฺฉูุฏ:
   - **Record Type**: A
   - **Name**: ูุงู ุณุงุจโุฏุงูู (ูุงููุฏ `calibri`)
   - **Value**: ุขุฏุฑุณ IP ุณุฑูุฑ ููุตุฏ
5. ุชุบุฑุงุช ุฑุง ุฐุฎุฑู ฺฉูุฏ.

#### **ุฑูุด ุฏูู: ุงุณุชูุงุฏู ุงุฒ Cloudflare**
1. ุจู ุญุณุงุจ ฺฉุงุฑุจุฑ ุฎูุฏ ุฏุฑ **Cloudflare** ูุงุฑุฏ ุดูุฏ.
2. ุงุฒ ูุณุช ุฏุงูููโูุงุ ุฏุงููู ููุฑุฏูุธุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
3. ุงุฒ ููู ุจุงูุง ุตูุญูุ ุจู ุจุฎุด **DNS** ุจุฑูุฏ.
4. ุฑู ุฏฺฉูู **+ Add record** ฺฉูฺฉ ฺฉูุฏ.
5. ุชูุธูุงุช ุฒุฑ ุฑุง ุงุนูุงู ฺฉูุฏ:
   - **Type**: A
   - **Name**: ูุงู ุณุงุจโุฏุงูู (ุจุฑุง ูุซุงู: `calibri`)
   - **IPv4 address**: ุขุฏุฑุณ IP ุณุฑูุฑ ููุตุฏ
   - **Proxy status**:
     - ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุงุจูุชโูุง ุงููุช ู ุจูููโุณุงุฒ Cloudflareุ ฺฏุฒูู **Proxied** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
     - ุจุฑุง ูุฏุงุช ูุณุชูู ุชุฑุงูฺฉ ุจู ุณุฑูุฑ ุจุฏูู ูุงุณุทู Cloudflareุ ฺฏุฒูู **DNS only** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
6. ุฑู ุฏฺฉูู **Save** ฺฉูฺฉ ฺฉูุฏ ุชุง ุฑฺฉูุฑุฏ ุฐุฎุฑู ุดูุฏ.

---

### ๐ ุณุฑูุณ ูุง ูุดุชุฑุงู

๐ Gateway (8061 - ...)

๐ Portal Backend (7061 - ...)

๐ Portal Frontend (6061 - ...)

---

### ๐ข ุงุจุฒุงุฑูุง ุฏูุงูพุณ

๐ฃ๏ธ Traefik (80) (user: admin - pass: admin)

๐ Splunk (8580)

๐ฅ Prometheus (9090)

๐ Grafana (9091)

โฐ Uptime Kuma (9092)

โป๏ธ Jenkins (4441)

๐ณ Portainer (4100) (set user and pass)

๐ Nginx (4101)

๐ฐ RabbitMQ (4102)

๐ฌ Apprise (4103)

โ๏ธ Mailserver (4104)

๐๏ธ phpMyAdmin (9281)

๐ pgAdmin (9282)

