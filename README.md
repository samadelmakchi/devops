# DevOps

### ðŸ”½ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù‡Ø§
``` bash
git clone https://github.com/samadelmakchi/devops.git
```
---

### âš™ï¸ Ù†ØµØ¨ Ùˆ Ú©Ø§Ù†ÙÛŒÚ¯ Ø³Ø±ÙˆØ±
``` bash
cd devops

bash -x setup.sh
```
---

### ðŸ¦Š Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù„ÛŒØ¯ SSH Ø¨Ù‡ Ø­Ø³Ø§Ø¨ GitLab / Github
Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¢Ø³Ø§Ù† Ùˆ Ø§Ù…Ù† Ø¨Ù‡ Ù…Ø®Ø§Ø²Ù† GitLabØŒ Ù„Ø·ÙØ§Ù‹ Ú©Ù„ÛŒØ¯ Ø¹Ù…ÙˆÙ…ÛŒ (Public Key) Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒâ€ŒØªØ§Ù† Ø§Ø¶Ø§ÙÙ‡ Ù†Ù…Ø§ÛŒÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø± Ù…Ø±Ø§Ø­Ù„ Ø²ÛŒØ± Ø±Ø§ Ø¯Ù†Ø¨Ø§Ù„ Ú©Ù†ÛŒØ¯:
1. ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø¯Ø± GitLab / Github Ø´ÙˆÛŒØ¯.
2. Ø¨Ù‡ ØµÙØ­Ù‡ `https://github.com/settings/ssh/new` / `https://gitlab.com/-/user_settings/ssh_keys` Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯:
3. ÙØ§ÛŒÙ„ Ú©Ù„ÛŒØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø´Ù…Ø§ Ø¨Ø§ Ù†Ø§Ù… `id_rsa.pub` Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙˆØ³Ø· Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `setup.sh` Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ùˆ Ø¯Ø± Ù¾ÙˆØ´Ù‡ Ø§ØµÙ„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯.
4. Ù…Ø­ØªÙˆØ§ÛŒ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± Ù‚Ø³Ù…Øª `Key` ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯.
5. ÛŒÚ© Ø¹Ù†ÙˆØ§Ù† Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø¯Ø± Ù‚Ø³Ù…Øª `Title` ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹: "DevOps").
6. Ø¯Ø± Ù¾Ø§ÛŒØ§Ù†ØŒ Ø±ÙˆÛŒ Ú¯Ø²ÛŒÙ†Ù‡ `Add key` Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.

---

### ðŸ¤– Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯ÙˆØ§Ù¾Ø³
Ù„Ø·ÙØ§Ù‹ Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ ÙØ±Ø¢ÛŒÙ†Ø¯ Ù†ØµØ¨ØŒ ÙØ§ÛŒÙ„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª `inventory-server.local.yml` Ø±Ø§ Ø¯Ø± Ù¾ÙˆØ´Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù‡ Ùˆ Ù…Ø·Ø§Ø¨Ù‚ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø®ÙˆØ¯ØŒ ØªØºÛŒÛŒØ±Ø§Øª Ù„Ø§Ø²Ù… Ø±Ø§ Ø¯Ø± Ø¢Ù† Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯.

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory-server.local.yml playbook-server.yml --ask-become-pass
```

---

### ðŸ“¦ Ù†ØµØ¨ Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù†
Ù„Ø·ÙØ§Ù‹ ÙØ§ÛŒÙ„ `inventory.local.yml` Ø±Ø§ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù‡ Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±Ø§ Ø¯Ø± Ø¢Ù† ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯.

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory.local.yml playbook.yml --ask-become-pass
```

---

### ðŸ§ª Ø§Ù†Ø¬Ø§Ù… ØªØ³Øª Ù‡Ø§ÛŒ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©

```bash
source ~/ansible-venv/bin/activate
ansible-playbook -i inventory.local.yml playbook-test.yml --ask-become-pass
```

---

### ðŸŒ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø®ØªØµØ§Øµ Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ† Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§

#### Ø±ÙˆØ´ Ø§ÙˆÙ„: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù¾Ù†Ù„ DirectAdmin
1. Ø¨Ù‡ Ù¾Ù†Ù„ DirectAdmin ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.
2. Ø¨Ù‡ Ø¨Ø®Ø´ DNS Management Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯.
3. Ø±ÙˆÛŒ Ú¯Ø²ÛŒÙ†Ù‡ Add Record Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.
4. ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯Ù†Ø¸Ø± Ø±Ø§ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø²ÛŒØ± ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯:
   - Record Type: A
   - Name: Ù†Ø§Ù… Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ† (Ù…Ø§Ù†Ù†Ø¯ `calibri`)
   - Value: Ø¢Ø¯Ø±Ø³ IP Ø³Ø±ÙˆØ± Ù…Ù‚ØµØ¯
5. ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯.

#### Ø±ÙˆØ´ Ø¯ÙˆÙ…: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Cloudflare
1. Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø¯Ø± Cloudflare ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.
2. Ø§Ø² Ù„ÛŒØ³Øª Ø¯Ø§Ù…Ù†Ù‡â€ŒÙ‡Ø§ØŒ Ø¯Ø§Ù…Ù†Ù‡ Ù…ÙˆØ±Ø¯Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.
3. Ø§Ø² Ù…Ù†ÙˆÛŒ Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡ØŒ Ø¨Ù‡ Ø¨Ø®Ø´ DNS Ø¨Ø±ÙˆÛŒØ¯.
4. Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ + Add record Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.
5. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø²ÛŒØ± Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯:
   - Type: A
   - Name: Ù†Ø§Ù… Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ† (Ø¨Ø±Ø§ÛŒ Ù…Ø«Ø§Ù„: `calibri`)
   - IPv4 address: Ø¢Ø¯Ø±Ø³ IP Ø³Ø±ÙˆØ± Ù…Ù‚ØµØ¯
   - Proxy status:
     - Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ CloudflareØŒ Ú¯Ø²ÛŒÙ†Ù‡ Proxied Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.
     - Ø¨Ø±Ø§ÛŒ Ù‡Ø¯Ø§ÛŒØª Ù…Ø³ØªÙ‚ÛŒÙ… ØªØ±Ø§ÙÛŒÚ© Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø¨Ø¯ÙˆÙ† ÙˆØ§Ø³Ø·Ù‡ CloudflareØŒ Ú¯Ø²ÛŒÙ†Ù‡ DNS only Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.
6. Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Save Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ø±Ú©ÙˆØ±Ø¯ Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯.

---

### ðŸ”† Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù†

ðŸ“œ Gateway (8061 - ...)

ðŸ“œ Portal Backend (7061 - ...)

ðŸ“œ Portal Frontend (6061 - ...)

---

### ðŸ’¢ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯ÙˆØ§Ù¾Ø³

ðŸ›£ï¸ Traefik (80) (user: admin - pass: admin)

ðŸ“Š Splunk (8580)

ðŸ”¥ Prometheus (9090)

ðŸ“ˆ Grafana (9091)

â° Uptime Kuma (9092)

â™»ï¸ Jenkins (4441)

ðŸ³ Portainer (4100) (set user and pass)

ðŸŒ Nginx (4101)

ðŸ° RabbitMQ (4102)

ðŸ“¬ Apprise (4103)

âœ‰ï¸ Mailserver (4104)

ðŸ—„ï¸ phpMyAdmin (9281)

ðŸ˜ pgAdmin (9282)



```mermaid

graph TD
   A[Ø´Ø±ÙˆØ¹] --> B{Ø¢ÛŒØ§ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡â€ŒØ§ÛŒØŸ}
   B -- Ø¨Ù„Ù‡ --> C[Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯]
   B -- Ø®ÛŒØ± --> D[Ù†Ù…Ø§ÛŒØ´ ÙØ±Ù… ÙˆØ±ÙˆØ¯]
   D --> E[Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª]
   E --> B

flowchart LR
   id1(This is the text in the box)

```